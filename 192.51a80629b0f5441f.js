"use strict";(self.webpackChunkforkstack_frontend=self.webpackChunkforkstack_frontend||[]).push([[192],{4192:(X,m,a)=>{a.r(m),a.d(m,{RecipesModule:()=>B});var p=a(177),e=a(540),d=a(1626),h=a(4796);let u=(()=>{class i{constructor(t,n){this.http=t,this.authService=n,this.apiUrl="https://e6q9keyixh.execute-api.us-east-1.amazonaws.com/prod/recipes"}authHeaders(){const t=this.authService.getToken();return new d.Lr({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}getAll(){return this.http.get(this.apiUrl,{headers:this.authHeaders()})}search(t){const n=(new d.Nl).set("title",t);return this.http.get(`${this.apiUrl}/search`,{headers:this.authHeaders(),params:n})}getById(t){return this.http.get(`${this.apiUrl}/${t}`,{headers:this.authHeaders()})}create(t){return this.http.post(this.apiUrl,t,{headers:this.authHeaders()})}update(t,n){return this.http.put(`${this.apiUrl}/${t}`,n,{headers:this.authHeaders()})}delete(t){return this.http.delete(`${this.apiUrl}/${t}`,{headers:this.authHeaders()})}parseUrl(t){return this.http.post(`${this.apiUrl}/parse-url`,{url:t},{headers:new d.Lr({"Content-Type":"application/json"})})}getTags(){return this.http.get("https://e6q9keyixh.execute-api.us-east-1.amazonaws.com/prod/tags",{headers:this.authHeaders()})}static{this.\u0275fac=function(n){return new(n||i)(e.KVO(d.Qq),e.KVO(h.u))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),_=(()=>{class i{constructor(){this.knownTags=["breakfast","appetizer","beverage","dessert","dinner","lunch","main course","salad","sandwich","side","snack","soup"],this.genericImages=["generic1.png","generic2.png","generic3.png","generic4.png"]}getImageForTags(t){if(!t?.length)return this.getRandomGenericImage();const n=t.filter(r=>this.knownTags.includes(r.toLowerCase()));return n.length?`assets/tag_images/${n[Math.floor(Math.random()*n.length)].toLowerCase()}.png`:this.getRandomGenericImage()}getRandomGenericImage(){return`assets/tag_images/generic/${this.genericImages[Math.floor(Math.random()*this.genericImages.length)]}`}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var g=a(6448),l=a(4341);function x(i,o){1&i&&(e.qSk(),e.joV(),e.j41(0,"div",12),e.EFF(1," No recipes found. "),e.k0s())}function b(i,o){if(1&i&&(e.j41(0,"p",18),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.Y8G("title",(null==t.recipe_tags?null:t.recipe_tags.join(" | "))||""),e.R7$(1),e.SpI(" ",(null==t.recipe_tags?null:t.recipe_tags.join(" | "))||""," ")}}const v=function(i){return[i]};function C(i,o){if(1&i&&(e.j41(0,"div",13),e.nrm(1,"img",14),e.j41(2,"div",15)(3,"h3",16),e.EFF(4),e.k0s(),e.DNE(5,b,2,2,"p",17),e.k0s()()),2&i){const t=o.$implicit;e.Y8G("routerLink",e.eq3(4,v,t.recipe_id)),e.R7$(1),e.Y8G("src",t.imageSrc,e.B4B),e.R7$(3),e.SpI(" ",t.title," "),e.R7$(1),e.Y8G("ngIf",null==t.recipe_tags?null:t.recipe_tags.length)}}let k=(()=>{class i{constructor(t,n){this.recipeService=t,this.imageHelper=n,this.recipes=[],this.filtered=[],this.page=1,this.search=""}ngOnInit(){this.loadAll()}loadAll(){this.recipeService.getAll().subscribe(t=>{this.recipes=t.map(n=>({...n,imageSrc:this.imageHelper.getImageForTags(n.recipe_tags)})),this.updateFiltered()})}searchRecipes(){this.search.trim()?this.recipeService.search(this.search).subscribe(t=>{this.recipes=t.map(n=>({...n,imageSrc:this.imageHelper.getImageForTags(n.recipe_tags)})),this.page=1,this.updateFiltered()}):this.loadAll()}updateFiltered(){const t=10*(this.page-1);this.filtered=this.recipes.slice(t,t+10)}nextPage(){10*this.page<this.recipes.length&&(this.page++,this.updateFiltered())}prevPage(){this.page>1&&(this.page--,this.updateFiltered())}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(u),e.rXU(_))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-recipes"]],decls:16,vars:6,consts:[[1,"max-w-5xl","mx-auto","px-4","py-8"],[1,"relative","text-textgray","w-full","max-w-md","mx-auto","mb-8"],["type","text","name","search","placeholder","Search",1,"bg-white","w-full","h-10","px-5","pr-10","rounded-full","text-sm","focus:outline-none","border","border-gray-300",3,"ngModel","ngModelChange","keyup.enter"],["type","button",1,"absolute","right-0","top-0","mt-2.5","mr-4",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 56.966 56.966",1,"h-4","w-4","fill-current","text-textgray","hover:text-accent"],["d","M55.146,51.887L41.588,37.786c3.486-4.144,\n          5.396-9.358,5.396-14.786c0-12.682-10.318-23-23-23s-23,10.318-23,23\n          s10.318,23,23,23c4.761,0,9.298-1.436,13.177-4.162l13.661,\n          14.208c0.571,0.593,1.339,0.92,2.162,0.92\n          c0.779,0,1.518-0.297,2.079-0.837\n          C56.255,54.982,56.293,53.08,55.146,51.887z\n          M23.984,6c9.374,0,17,7.626,17,17s-7.626,17-17,17\n          s-17-7.626-17-17S14.61,6,23.984,6z"],["class","text-center text-sm text-gray-500",4,"ngIf"],[1,"grid","grid-cols-2","gap-4","max-w-xl","mx-auto"],["class","bg-white rounded-lg shadow hover:shadow-md overflow-hidden cursor-pointer aspect-square",3,"routerLink",4,"ngFor","ngForOf"],[1,"flex","justify-center","items-center","gap-4","mt-6"],[1,"pagination-button",3,"disabled","click"],[1,"text-textgray"],[1,"text-center","text-sm","text-gray-500"],[1,"bg-white","rounded-lg","shadow","hover:shadow-md","overflow-hidden","cursor-pointer","aspect-square",3,"routerLink"],["alt","Recipe image",1,"w-full","h-2/3","sm:h-4/5","object-cover",3,"src"],[1,"p-2","flex","flex-col","justify-center","items-center","text-center"],[1,"text-xs","sm:text-sm","font-semibold","text-textgray","break-words"],["class","text-xs text-gray-500 mt-1 truncate w-full text-center",3,"title",4,"ngIf"],[1,"text-xs","text-gray-500","mt-1","truncate","w-full","text-center",3,"title"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"input",2),e.bIt("ngModelChange",function(c){return r.search=c})("keyup.enter",function(){return r.searchRecipes()}),e.k0s(),e.j41(3,"button",3),e.bIt("click",function(){return r.searchRecipes()}),e.qSk(),e.j41(4,"svg",4),e.nrm(5,"path",5),e.k0s()()(),e.DNE(6,x,2,0,"div",6),e.joV(),e.j41(7,"div",7),e.DNE(8,C,6,6,"div",8),e.k0s(),e.j41(9,"div",9)(10,"button",10),e.bIt("click",function(){return r.prevPage()}),e.EFF(11," < "),e.k0s(),e.j41(12,"span",11),e.EFF(13),e.k0s(),e.j41(14,"button",10),e.bIt("click",function(){return r.nextPage()}),e.EFF(15," > "),e.k0s()()()),2&n&&(e.R7$(2),e.Y8G("ngModel",r.search),e.R7$(4),e.Y8G("ngIf",0===r.filtered.length),e.R7$(2),e.Y8G("ngForOf",r.filtered),e.R7$(2),e.Y8G("disabled",1===r.page),e.R7$(3),e.JRh(r.page),e.R7$(1),e.Y8G("disabled",10*r.page>=r.recipes.length))},dependencies:[p.Sq,p.bT,g.Wk,l.me,l.BC,l.vS],styles:[".container[_ngcontent-%COMP%]{max-width:600px;margin:auto;padding:1rem}input[_ngcontent-%COMP%]{width:100%;padding:.5rem;margin-bottom:1rem}.recipe[_ngcontent-%COMP%]{background:#f5f5f5;margin-bottom:1rem;padding:1rem;border-radius:8px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]})}}return i})();function y(i,o){if(1&i&&(e.j41(0,"a",27),e.nrm(1,"img",28)(2,"img",29),e.k0s()),2&i){const t=e.XpG(3);e.Y8G("href",t.recipe.import_source_url,e.B4B)}}const w=function(i){return["/recipes",i,"edit"]};function F(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",19),e.DNE(1,y,3,1,"a",20),e.j41(2,"a",21),e.nrm(3,"img",22)(4,"img",23),e.k0s(),e.j41(5,"button",24),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.deleteRecipe())}),e.nrm(6,"img",25)(7,"img",26),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",t.recipe.import_source_url),e.R7$(1),e.Y8G("routerLink",e.eq3(2,w,t.recipe.recipe_id))}}function R(i,o){if(1&i&&(e.j41(0,"span",32),e.EFF(1),e.k0s()),2&i){const t=o.$implicit;e.R7$(1),e.SpI(" ",t," ")}}function M(i,o){if(1&i&&(e.j41(0,"div",30),e.DNE(1,R,2,1,"span",31),e.k0s()),2&i){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.recipe.recipe_tags)}}function j(i,o){if(1&i&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&i){const t=o.$implicit;e.R7$(1),e.E5c(" ",t.quantity," ",t.measurement_type," ",t.name," ")}}function I(i,o){if(1&i&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&i){const t=o.$implicit;e.R7$(1),e.SpI(" ",t.text," ")}}function O(i,o){if(1&i&&(e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"h1",6),e.EFF(4),e.k0s(),e.DNE(5,F,8,4,"div",7),e.k0s()(),e.DNE(6,M,2,1,"div",8),e.j41(7,"div",9)(8,"div",10),e.nrm(9,"img",11),e.k0s()(),e.j41(10,"div",12)(11,"div",13)(12,"h2",14),e.EFF(13,"Ingredients"),e.k0s(),e.j41(14,"ul",15),e.DNE(15,j,2,3,"li",16),e.k0s()(),e.j41(16,"div",17),e.nrm(17,"img",11),e.k0s()(),e.j41(18,"div")(19,"h2",14),e.EFF(20,"Instructions"),e.k0s(),e.j41(21,"ol",18),e.DNE(22,I,2,1,"li",16),e.k0s()()()),2&i){const t=e.XpG();e.R7$(4),e.SpI(" ",t.recipe.title," "),e.R7$(1),e.Y8G("ngIf",t.isOwner()),e.R7$(1),e.Y8G("ngIf",null==t.recipe.recipe_tags?null:t.recipe.recipe_tags.length),e.R7$(3),e.Y8G("src",t.imageHelper.getImageForTags(null==t.recipe?null:t.recipe.recipe_tags),e.B4B),e.R7$(6),e.Y8G("ngForOf",t.recipe.ingredients),e.R7$(2),e.Y8G("src",t.imageHelper.getImageForTags(null==t.recipe?null:t.recipe.recipe_tags),e.B4B),e.R7$(5),e.Y8G("ngForOf",t.recipe.instructions)}}function T(i,o){1&i&&(e.j41(0,"div",33),e.EFF(1,"Loading recipe..."),e.k0s())}function P(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",34)(1,"div",35)(2,"h2",36),e.EFF(3,"Delete Recipe?"),e.k0s(),e.j41(4,"p",37),e.EFF(5,"This action cannot be undone."),e.k0s(),e.j41(6,"div",38)(7,"button",39),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showConfirm=!1)}),e.EFF(8," Cancel "),e.k0s(),e.j41(9,"button",40),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return r.confirmDelete(),e.Njj(r.showConfirm=!1)}),e.EFF(10," Delete "),e.k0s()()()()}}let $=(()=>{class i{constructor(t,n,r,s,c){this.route=t,this.recipeService=n,this.router=r,this.auth=s,this.imageHelper=c,this.showConfirm=!1}ngOnInit(){const t=this.route.snapshot.paramMap.get("id");t&&this.recipeService.getById(t).subscribe(n=>{this.recipe=n})}deleteRecipe(){this.showConfirm=!0}confirmDelete(){this.recipe&&this.recipeService.delete(this.recipe.recipe_id).subscribe(()=>{this.router.navigate(["/recipes"])})}isOwner(){const t=this.auth.getUserId();return this.recipe?.owner_id===t}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(g.nX),e.rXU(u),e.rXU(g.Ix),e.rXU(h.u),e.rXU(_))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-recipe-detail"]],decls:4,vars:3,consts:[["class","max-w-4xl mx-auto px-4 py-8 text-textgray",4,"ngIf","ngIfElse"],["loading",""],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",4,"ngIf"],[1,"max-w-4xl","mx-auto","px-4","py-8","text-textgray"],[1,"flex","items-center","justify-between","flex-wrap","mb-1","gap-2"],[1,"flex","items-center","gap-3"],[1,"text-3xl","sm:text-4xl","font-bold","break-words"],["class","flex gap-2 mb-1",4,"ngIf"],["class","flex flex-wrap gap-2 mb-4",4,"ngIf"],[1,"w-full","max-w-xs","mx-auto","sm:hidden","mb-6"],[1,"aspect-square","rounded","overflow-hidden","shadow"],["alt","Recipe image",1,"w-full","h-full","object-cover",3,"src"],[1,"grid","sm:grid-cols-3","gap-6","mb-8"],[1,"sm:col-span-2"],[1,"text-xl","font-semibold","mb-2"],[1,"list-disc","pl-5","space-y-1"],[4,"ngFor","ngForOf"],[1,"hidden","sm:block","w-full","max-w-xs","aspect-square","rounded","overflow-hidden","shadow"],[1,"list-decimal","pl-5","space-y-2"],[1,"flex","gap-2","mb-1"],["target","_blank","rel","noopener noreferrer","title","View Originals","class","group relative h-6 w-6 block transition",3,"href",4,"ngIf"],["title","Edit",1,"group","relative","h-6","w-6","block","transition",3,"routerLink"],["src","assets/edit.svg","alt","Edit",1,"h-6","w-6","absolute","inset-0","group-hover:opacity-0","transition-opacity","duration-200"],["src","assets/edit-hover.svg","alt","Edit Hover",1,"h-6","w-6","absolute","inset-0","opacity-0","group-hover:opacity-100","transition-opacity","duration-200"],["title","Delete",1,"group","relative","h-6","w-6","block","transition",3,"click"],["src","assets/delete.svg","alt","Delete",1,"h-6","w-6","absolute","inset-0","group-hover:opacity-0","transition-opacity","duration-200"],["src","assets/delete-hover.svg","alt","Delete Hover",1,"h-6","w-6","absolute","inset-0","opacity-0","group-hover:opacity-100","transition-opacity","duration-200"],["target","_blank","rel","noopener noreferrer","title","View Originals",1,"group","relative","h-6","w-6","block","transition",3,"href"],["src","assets/link.svg","alt","View Original",1,"h-6","w-6","absolute","inset-0","group-hover:opacity-0","transition-opacity","duration-200"],["src","assets/link-hover.svg","alt","View Original Hover",1,"h-6","w-6","absolute","inset-0","opacity-0","group-hover:opacity-100","transition-opacity","duration-200"],[1,"flex","flex-wrap","gap-2","mb-4"],["class","text-sm border px-2 py-1 rounded",4,"ngFor","ngForOf"],[1,"text-sm","border","px-2","py-1","rounded"],[1,"text-center","py-12","text-gray-400"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-lg","p-6","w-80","max-w-full","shadow-lg","text-center"],[1,"text-xl","font-semibold","text-textgray","mb-4"],[1,"text-sm","text-gray-600","mb-6"],[1,"flex","justify-center","gap-4"],[1,"px-4","py-2","bg-gray-200","text-gray-700","rounded","hover:bg-gray-300",3,"click"],[1,"px-4","py-2","bg-red-600","text-white","rounded","hover:bg-red-700",3,"click"]],template:function(n,r){if(1&n&&(e.DNE(0,O,23,7,"div",0),e.DNE(1,T,2,0,"ng-template",null,1,e.C5r),e.DNE(3,P,11,0,"div",2)),2&n){const s=e.sdS(2);e.Y8G("ngIf",r.recipe)("ngIfElse",s),e.R7$(3),e.Y8G("ngIf",r.showConfirm)}},dependencies:[p.Sq,p.bT,g.Wk]})}}return i})();function E(i,o){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"label",29)(2,"input",30,31),e.bIt("change",function(){const s=e.eBV(t).$implicit,c=e.sdS(3),V=e.XpG(2);return e.Njj(V.onTagToggle(s.name,c.checked))}),e.k0s(),e.EFF(4),e.k0s()()}if(2&i){const t=o.$implicit,n=e.XpG(2);e.R7$(2),e.Y8G("checked",n.recipe_tags.includes(t.name))("disabled",!n.recipe_tags.includes(t.name)&&n.recipe_tags.length>=5),e.R7$(2),e.SpI(" ",t.name," ")}}function G(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",25)(1,"input",26),e.bIt("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.Njj(s.tagSearch=r)}),e.k0s(),e.j41(2,"p",27),e.EFF(3),e.k0s(),e.DNE(4,E,5,3,"div",28),e.k0s()}if(2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngModel",t.tagSearch),e.R7$(2),e.SpI(" ",t.recipe_tags.length,"/5 selected "),e.R7$(1),e.Y8G("ngForOf",t.filteredTags())}}function S(i,o){if(1&i&&(e.j41(0,"span",32),e.EFF(1),e.k0s()),2&i){const t=o.$implicit;e.R7$(1),e.SpI(" ",t," ")}}function D(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",33)(1,"input",34),e.bIt("ngModelChange",function(r){const c=e.eBV(t).$implicit;return e.Njj(c.quantity=r)}),e.k0s(),e.j41(2,"input",35),e.bIt("ngModelChange",function(r){const c=e.eBV(t).$implicit;return e.Njj(c.measurement_type=r)}),e.k0s(),e.j41(3,"div",36)(4,"input",37),e.bIt("ngModelChange",function(r){const c=e.eBV(t).$implicit;return e.Njj(c.name=r)}),e.k0s(),e.j41(5,"button",38),e.bIt("click",function(){const s=e.eBV(t).index,c=e.XpG();return e.Njj(c.removeIngredient(s))}),e.EFF(6," \u2212 "),e.k0s()()()}if(2&i){const t=o.$implicit,n=o.index;e.R7$(1),e.Mz_("name","qty-",n,""),e.Y8G("ngModel",t.quantity),e.R7$(1),e.Mz_("name","unit-",n,""),e.Y8G("ngModel",t.measurement_type),e.R7$(2),e.Mz_("name","name-",n,""),e.Y8G("ngModel",t.name)}}function Y(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",39)(1,"span",40),e.EFF(2),e.k0s(),e.j41(3,"textarea",41),e.bIt("ngModelChange",function(r){const c=e.eBV(t).$implicit;return e.Njj(c.text=r)}),e.k0s(),e.j41(4,"button",42),e.bIt("click",function(){const s=e.eBV(t).index,c=e.XpG();return e.Njj(c.removeInstruction(s))}),e.EFF(5," \u2212 "),e.k0s()()}if(2&i){const t=o.$implicit,n=o.index;e.R7$(2),e.SpI("",n+1,"."),e.R7$(1),e.Mz_("name","step-",n,""),e.Y8G("ngModel",t.text)}}function U(i,o){if(1&i&&(e.j41(0,"div",51),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(1),e.SpI(" ",t.parseError," ")}}function N(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",43)(1,"div",44)(2,"h3",45),e.EFF(3,"Import Recipe"),e.k0s(),e.DNE(4,U,2,1,"div",46),e.j41(5,"input",47),e.bIt("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.Njj(s.recipeUrl=r)}),e.k0s(),e.j41(6,"div",48)(7,"button",49),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showParser=!1)}),e.EFF(8," Cancel "),e.k0s(),e.j41(9,"button",50),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.parseRecipeUrl())}),e.EFF(10),e.k0s()()()()}if(2&i){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",t.parseError),e.R7$(1),e.Y8G("ngModel",t.recipeUrl),e.R7$(4),e.Y8G("disabled",t.isParsing),e.R7$(1),e.SpI(" ",t.isParsing?"Importing...":"Import"," ")}}let f=(()=>{class i{constructor(t,n,r){this.recipeService=t,this.route=n,this.router=r,this.title="",this.ingredients=[{name:"",quantity:"",measurement_type:""}],this.instructions=[{step_number:1,text:""}],this.editing=!1,this.recipe_id=null,this.is_shareable=!1,this.recipeUrl="",this.showParser=!1,this.isParsing=!1,this.parseError=null,this.recipe_tags=[],this.availableTags=[],this.showTagDropdown=!1,this.tagSearch=""}ngOnInit(){this.recipe_id=this.route.snapshot.paramMap.get("id"),this.editing=!!this.recipe_id,this.recipeService.getTags().subscribe(t=>{this.availableTags=t,this.editing&&this.recipe_id&&this.recipeService.getById(this.recipe_id).subscribe(n=>{this.title=n.title,this.ingredients=n.ingredients,this.instructions=n.instructions,this.is_shareable=n.is_shareable,this.recipeUrl=n.import_source_url||"",this.recipe_tags=n.recipe_tags||[]})})}addIngredient(){this.ingredients.push({name:"",quantity:"",measurement_type:""})}removeIngredient(t){this.ingredients.splice(t,1)}addInstruction(){this.instructions.push({step_number:this.instructions.length+1,text:""})}removeInstruction(t){this.instructions.splice(t,1),this.reindexInstructions()}moveInstructionUp(t){if(t>0){const n=[...this.instructions];[n[t-1],n[t]]=[n[t],n[t-1]],this.instructions=n,this.reindexInstructions()}}moveInstructionDown(t){if(t<this.instructions.length-1){const n=[...this.instructions];[n[t+1],n[t]]=[n[t],n[t+1]],this.instructions=n,this.reindexInstructions()}}reindexInstructions(){this.instructions.forEach((t,n)=>t.step_number=n+1)}parseRecipeUrl(){this.recipeUrl&&(this.isParsing=!0,this.parseError=null,this.recipeService.parseUrl(this.recipeUrl).subscribe({next:t=>{this.title=t.title,this.ingredients=t.ingredients||[{name:"",quantity:"",measurement_type:""}],this.instructions=t.instructions||[{step_number:1,text:""}],this.reindexInstructions(),this.isParsing=!1,this.showParser=!1},error:t=>{console.error("Parse failed",t),this.parseError="Failed to parse recipe. Try another URL.",this.isParsing=!1}}))}submit(){const t={title:this.title,ingredients:this.ingredients,instructions:this.instructions,is_shareable:this.is_shareable,recipe_tags:this.recipe_tags};!this.editing&&this.recipeUrl.trim()&&(t.import_source_url=this.recipeUrl.trim());const n=()=>this.router.navigate(["/recipes"]);this.editing&&this.recipe_id?this.recipeService.update(this.recipe_id,t).subscribe(n):this.recipeService.create(t).subscribe(n)}onTagToggle(t,n){n&&!this.recipe_tags.includes(t)?this.recipe_tags.length<5&&this.recipe_tags.push(t):this.recipe_tags=this.recipe_tags.filter(r=>r!==t)}toggleTagDropdown(){this.showTagDropdown=!this.showTagDropdown,this.tagSearch=""}filteredTags(){const t=this.tagSearch.toLowerCase();return this.availableTags.filter(n=>n.name.toLowerCase().includes(t))}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(u),e.rXU(g.nX),e.rXU(g.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-recipe-form"]],decls:34,vars:8,consts:[[1,"max-w-4xl","mx-auto","px-4","py-8"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-3"],["name","title","required","","placeholder","Recipe Title",1,"border","border-gray-300","rounded","px-3","py-2","w-full","sm:flex-1","focus:outline-none","focus:ring-2","focus:ring-accent",3,"ngModel","ngModelChange"],[1,"flex","gap-2","sm:ml-auto","w-full","sm:w-auto"],[1,"bg-accent","text-white","px-4","py-2","rounded","hover:bg-primary","hover:text-white","w-full","sm:w-auto",3,"click"],[1,"px-4","py-2","rounded","hover:opacity-90","transition","w-full","sm:w-auto",3,"ngClass","click"],[1,"mt-4","mb-4","flex","items-start","gap-4","relative"],["type","button",1,"text-sm","bg-accent","text-white","px-3","py-1","rounded","hover:bg-primary","transition",3,"click"],["class","absolute z-10 mt-1 w-64 max-h-64 overflow-y-auto bg-white border rounded shadow p-2",4,"ngIf"],[1,"flex","flex-wrap","gap-2","items-center","pt-1"],["class","text-sm px-2 py-1 rounded",4,"ngFor","ngForOf"],[1,"mt-6","grid","grid-cols-1","md:grid-cols-3","gap-6","items-start"],[1,"md:col-span-2","order-2","md:order-1"],[1,"text-xl","font-semibold","text-textgray","mb-2"],[1,"flex","flex-col","gap-2"],["class","grid grid-cols-8 gap-2 items-center",4,"ngFor","ngForOf"],["type","button",1,"text-accent","font-bold","mt-2",3,"click"],[1,"md:col-span-3","order-3"],[1,"text-xl","font-semibold","text-textgray","mt-6","mb-2"],[1,"flex","flex-col","gap-3"],["class","flex gap-2 items-start",4,"ngFor","ngForOf"],["type","button",1,"text-accent","font-bold",3,"click"],[1,"mt-8","text-center"],["type","submit",1,"bg-textgray","text-white","px-6","py-3","rounded","hover:bg-accent","hover:text-textgray","transition",3,"click"],["class","fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",4,"ngIf"],[1,"absolute","z-10","mt-1","w-64","max-h-64","overflow-y-auto","bg-white","border","rounded","shadow","p-2"],["type","text","placeholder","Search tags...",1,"w-full","mb-2","p-1","border","rounded","text-sm",3,"ngModel","ngModelChange"],[1,"text-xs","text-gray-500","mt-2","text-center"],[4,"ngFor","ngForOf"],[1,"flex","items-center","gap-2","text-sm","py-1"],["type","checkbox",3,"checked","disabled","change"],["inputRef",""],[1,"text-sm","px-2","py-1","rounded"],[1,"grid","grid-cols-8","gap-2","items-center"],["placeholder","Qty",1,"col-span-1","border","px-2","py-1","rounded","w-full",3,"ngModel","name","ngModelChange"],["placeholder","Unit",1,"col-span-2","border","px-2","py-1","rounded","w-full",3,"ngModel","name","ngModelChange"],[1,"col-span-5","flex","gap-2"],["placeholder","Ingredient",1,"border","px-2","py-1","rounded","w-full",3,"ngModel","name","ngModelChange"],["type","button","title","Remove",1,"bg-red-200","hover:bg-red-300","text-red-800","px-2","rounded","font-bold",3,"click"],[1,"flex","gap-2","items-start"],[1,"font-bold","mt-2"],["placeholder","Instruction step","required","","rows","3",1,"border","px-3","py-2","rounded","w-full","resize-y","min-h-[5rem]","focus:outline-none","focus:ring-2","focus:ring-accent",3,"ngModel","name","ngModelChange"],["type","button","title","Remove",1,"bg-red-200","hover:bg-red-300","text-red-800","px-2","rounded","font-bold","mt-2",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","justify-center","items-center","z-50"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-md"],[1,"text-lg","font-semibold","text-textgray","mb-4"],["class","text-red-500 text-sm mt-2",4,"ngIf"],["placeholder","Paste recipe URL",1,"border","px-3","py-2","rounded","w-full","mb-4",3,"ngModel","ngModelChange"],[1,"flex","justify-end","gap-2"],[1,"text-textgray","px-4","py-2","rounded","hover:bg-gray-100",3,"click"],[1,"bg-accent","text-white","px-4","py-2","rounded","hover:bg-primary",3,"disabled","click"],[1,"text-red-500","text-sm","mt-2"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"input",2),e.bIt("ngModelChange",function(c){return r.title=c}),e.k0s(),e.j41(3,"div",3)(4,"button",4),e.bIt("click",function(){return r.showParser=!0}),e.EFF(5," Import "),e.k0s(),e.j41(6,"button",5),e.bIt("click",function(){return r.is_shareable=!r.is_shareable}),e.EFF(7),e.k0s()()(),e.j41(8,"div",6)(9,"div")(10,"button",7),e.bIt("click",function(){return r.toggleTagDropdown()}),e.EFF(11," + Tags "),e.k0s(),e.DNE(12,G,5,3,"div",8),e.k0s(),e.j41(13,"div",9),e.DNE(14,S,2,1,"span",10),e.k0s()(),e.j41(15,"div",11)(16,"div",12)(17,"h2",13),e.EFF(18,"Ingredients"),e.k0s(),e.j41(19,"div",14),e.DNE(20,D,7,6,"div",15),e.j41(21,"button",16),e.bIt("click",function(){return r.addIngredient()}),e.EFF(22," + Add Ingredient "),e.k0s()()(),e.j41(23,"div",17)(24,"h2",18),e.EFF(25," Instructions "),e.k0s(),e.j41(26,"div",19),e.DNE(27,Y,6,3,"div",20),e.j41(28,"button",21),e.bIt("click",function(){return r.addInstruction()}),e.EFF(29," + Add Step "),e.k0s()()()(),e.j41(30,"div",22)(31,"button",23),e.bIt("click",function(){return r.submit()}),e.EFF(32," Save Recipe "),e.k0s()(),e.DNE(33,N,11,4,"div",24),e.k0s()),2&n&&(e.R7$(2),e.Y8G("ngModel",r.title),e.R7$(4),e.Y8G("ngClass",r.is_shareable?"bg-primary text-white":"bg-gray-300 text-textgray"),e.R7$(1),e.SpI(" ",r.is_shareable?"Share \u2705":"Share \u274c"," "),e.R7$(5),e.Y8G("ngIf",r.showTagDropdown),e.R7$(2),e.Y8G("ngForOf",r.recipe_tags),e.R7$(6),e.Y8G("ngForOf",r.ingredients),e.R7$(7),e.Y8G("ngForOf",r.instructions),e.R7$(6),e.Y8G("ngIf",r.showParser))},dependencies:[p.YU,p.Sq,p.bT,l.me,l.BC,l.YS,l.vS],styles:["form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;display:flex;flex-direction:column;gap:1.5rem;padding:1rem}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.25rem}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.5rem;font-size:1rem;width:100%;border:1px solid #ccc;border-radius:4px}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#666}form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:100px}form[_ngcontent-%COMP%]   .ingredient-group[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;align-items:center;gap:.5rem;margin-bottom:.5rem}form[_ngcontent-%COMP%]   .ingredient-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.5rem;font-size:1rem;border:1px solid #ccc;border-radius:4px}form[_ngcontent-%COMP%]   .ingredient-group[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1 1 auto;min-width:140px}form[_ngcontent-%COMP%]   .ingredient-group[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{width:70px;flex-shrink:0}form[_ngcontent-%COMP%]   .ingredient-group[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{width:100px;flex-shrink:0}form[_ngcontent-%COMP%]   .ingredient-group[_ngcontent-%COMP%]   .circle-btn[_ngcontent-%COMP%]{width:32px;height:32px;font-size:1.2rem;flex-shrink:0;line-height:1;padding:0;display:flex;align-items:center;justify-content:center}form[_ngcontent-%COMP%]   .instructions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}form[_ngcontent-%COMP%]   .instructions[_ngcontent-%COMP%]   .instruction-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}form[_ngcontent-%COMP%]   .instructions[_ngcontent-%COMP%]   .instruction-group[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{width:2rem;font-weight:700}form[_ngcontent-%COMP%]   .instructions[_ngcontent-%COMP%]   .instruction-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.5rem;font-size:1rem}form[_ngcontent-%COMP%]   .instructions[_ngcontent-%COMP%]   .instruction-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:1rem;cursor:pointer}form[_ngcontent-%COMP%]   .circle-btn[_ngcontent-%COMP%]{background-color:#2c3e50;color:#fff;border:none;border-radius:50%;width:2rem;height:2rem;font-size:1.2rem;line-height:1rem;text-align:center;padding:0;cursor:pointer}form[_ngcontent-%COMP%]   .circle-btn[_ngcontent-%COMP%]:hover{background-color:#1a252f}form[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]{margin-top:1rem}"]})}}return i})(),B=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[p.MD,g.iI.forChild([{path:"",component:k},{path:"new",component:f},{path:":id",component:$},{path:":id/edit",component:f}]),l.YN,d.q1]})}}return i})()}}]);